<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EasyHPO Examples - MAT-HPO Library</title>
    <meta name="description" content="Complete working examples of EasyHPO interface with LLM enhancement">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ¤–</text></svg>">
</head>
<body>
    <button class="mobile-toggle">â˜°</button>

    <div class="container">
        <nav class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="logo">
                    <div class="logo-icon">M</div>
                    <div class="logo-text">
                        <h1>MAT-HPO</h1>
                        <p>Multi-Agent HPO</p>
                    </div>
                </a>
                <div style="margin-top: 1rem;">
                    <span class="version-badge">v1.1.0</span>
                </div>
            </div>

            <ul class="nav-menu">
                <li class="nav-item">
                    <div class="nav-section">Getting Started</div>
                </li>
                <li class="nav-item">
                    <a href="../index.html" class="nav-link">Home</a>
                </li>
                <li class="nav-item">
                    <a href="../installation.html" class="nav-link">Installation</a>
                </li>
                <li class="nav-item">
                    <a href="../quickstart.html" class="nav-link">Quick Start</a>
                </li>
                <li class="nav-item">
                    <a href="../easy-hpo.html" class="nav-link">EasyHPO Interface</a>
                </li>

                <li class="nav-item">
                    <div class="nav-section">Advanced Features</div>
                </li>
                <li class="nav-item">
                    <a href="../custom-metrics.html" class="nav-link">Custom Metrics & Rewards</a>
                </li>
                <li class="nav-item">
                    <a href="../llm-strategies.html" class="nav-link">LLM Strategies</a>
                </li>

                <li class="nav-item">
                    <div class="nav-section">API Reference</div>
                </li>
                <li class="nav-item">
                    <a href="../api/base-environment.html" class="nav-link">BaseEnvironment</a>
                </li>
                <li class="nav-item">
                    <a href="../api/hyperparameter-space.html" class="nav-link">HyperparameterSpace</a>
                </li>
                <li class="nav-item">
                    <a href="../api/optimizer.html" class="nav-link">MAT_HPO_Optimizer</a>
                </li>
                <li class="nav-item">
                    <a href="../api/configs.html" class="nav-link">Configs</a>
                </li>

                <li class="nav-item">
                    <div class="nav-section">Examples</div>
                </li>
                <li class="nav-item">
                    <a href="simple.html" class="nav-link">Simple Example</a>
                </li>
                <li class="nav-item">
                    <a href="easy-hpo.html" class="nav-link active">EasyHPO Examples</a>
                </li>
                <li class="nav-item">
                    <a href="full-control.html" class="nav-link">Full Control Examples</a>
                </li>

                <li class="nav-item">
                    <div class="nav-section">Resources</div>
                </li>
                <li class="nav-item">
                    <a href="https://github.com/VM230705/MAT-HPO-Library" class="nav-link external">GitHub</a>
                </li>
            </ul>
        </nav>

        <main class="content">
            <div class="content-header">
                <nav class="breadcrumb">
                    <a href="../index.html">Home</a> &gt; <a href="../examples/">Examples</a> &gt; EasyHPO Examples
                </nav>
                <h1>ğŸš€ EasyHPO Examples</h1>
                <p class="subtitle">Complete working examples using the simplified EasyHPO interface</p>
            </div>

            <div class="main-content">

                <section class="content-section">
                    <h2>ğŸ“Š Example 1: Basic Classification</h2>

                    <p>The simplest way to get started with EasyHPO:</p>

                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-language">python</span>
                            <button class="copy-btn">Copy</button>
                        </div>
                        <pre><code class="language-python"><span class="token keyword">from</span> MAT_HPO_LIB <span class="token keyword">import</span> EasyHPO
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> make_classification
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split

<span class="token comment"># ğŸ“Š Create sample dataset</span>
X<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token function">make_classification</span><span class="token punctuation">(</span>
    n_samples<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span>
    n_features<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span>
    n_classes<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>
    n_informative<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">,</span>
    random_state<span class="token operator">=</span><span class="token number">42</span>
<span class="token punctuation">)</span>

<span class="token comment"># ğŸ”€ Split data</span>
X_train<span class="token punctuation">,</span> X_val<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_val <span class="token operator">=</span> <span class="token function">train_test_split</span><span class="token punctuation">(</span>
    X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> stratify<span class="token operator">=</span>y<span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span>
<span class="token punctuation">)</span>

<span class="token comment"># ğŸš€ One-liner optimization</span>
optimizer <span class="token operator">=</span> <span class="token function">EasyHPO</span><span class="token punctuation">(</span>
    task_type<span class="token operator">=</span><span class="token string">"classification"</span><span class="token punctuation">,</span>
    max_trials<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span>
    verbose<span class="token operator">=</span><span class="token boolean">True</span>
<span class="token punctuation">)</span>

<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">"ğŸš€ Starting basic classification optimization..."</span><span class="token punctuation">)</span>
results <span class="token operator">=</span> optimizer<span class="token punctuation">.</span><span class="token function">optimize</span><span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> X_val<span class="token punctuation">,</span> y_val<span class="token punctuation">)</span>

<span class="token comment"># ğŸ† Display results</span>
<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">f"\\nğŸ† Best Performance:"</span><span class="token punctuation">)</span>
<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">f"   F1 Score: {results['best_performance']['f1']:.4f}"</span><span class="token punctuation">)</span>
<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">f"   Accuracy: {results['best_performance'].get('accuracy', 'N/A')}"</span><span class="token punctuation">)</span>

<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">f"\\nâš™ï¸ Best Hyperparameters:"</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> param<span class="token punctuation">,</span> value <span class="token keyword">in</span> results<span class="token punctuation">[</span><span class="token string">'best_hyperparameters'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">items</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">f"   {param}: {value}"</span><span class="token punctuation">)</span></code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>ğŸ§  Example 2: LLM-Enhanced Time Series Classification</h2>

                    <p>Using LLM enhancement for intelligent hyperparameter suggestions:</p>

                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-language">python</span>
                            <button class="copy-btn">Copy</button>
                        </div>
                        <pre><code class="language-python"><span class="token keyword">from</span> MAT_HPO_LIB <span class="token keyword">import</span> EasyHPO
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split

<span class="token comment"># ğŸ“Š Create time series data</span>
<span class="token keyword">def</span> <span class="token function">create_time_series_data</span><span class="token punctuation">(</span>n_samples<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span> sequence_length<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> n_classes<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">"""Generate synthetic time series classification data"""</span>
    X <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span><span class="token function">randn</span><span class="token punctuation">(</span>n_samples<span class="token punctuation">,</span> sequence_length<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token comment"># Add class-specific patterns</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n_samples<span class="token punctuation">)</span><span class="token punctuation">:</span>
        class_label <span class="token operator">=</span> i <span class="token operator">%</span> n_classes
        <span class="token keyword">if</span> class_label <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            X<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> np<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token function">linspace</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token operator">*</span>np<span class="token punctuation">.</span>pi<span class="token punctuation">,</span> sequence_length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reshape</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">elif</span> class_label <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
            X<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> np<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token function">linspace</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">*</span>np<span class="token punctuation">.</span>pi<span class="token punctuation">,</span> sequence_length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reshape</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>

    y <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token function">array</span><span class="token punctuation">(</span><span class="token punctuation">[</span>i <span class="token operator">%</span> n_classes <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n_samples<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> X<span class="token punctuation">,</span> y

<span class="token comment"># ğŸ“Š Generate data</span>
X<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token function">create_time_series_data</span><span class="token punctuation">(</span>n_samples<span class="token operator">=</span><span class="token number">1500</span><span class="token punctuation">,</span> sequence_length<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span>
X_train<span class="token punctuation">,</span> X_val<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_val <span class="token operator">=</span> <span class="token function">train_test_split</span><span class="token punctuation">(</span>
    X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> stratify<span class="token operator">=</span>y<span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span>
<span class="token punctuation">)</span>

<span class="token comment"># ğŸ§  LLM-enhanced optimization with adaptive strategy</span>
optimizer <span class="token operator">=</span> <span class="token function">EasyHPO</span><span class="token punctuation">(</span>
    task_type<span class="token operator">=</span><span class="token string">"time_series_classification"</span><span class="token punctuation">,</span>
    llm_enabled<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>              <span class="token comment"># ğŸ§  Enable LLM enhancement</span>
    llm_strategy<span class="token operator">=</span><span class="token string">"adaptive"</span><span class="token punctuation">,</span>        <span class="token comment"># Smart adaptive strategy</span>
    llm_config<span class="token operator">=</span><span class="token punctuation">{</span>
        <span class="token string">'performance_threshold'</span><span class="token punctuation">:</span> <span class="token number">0.01</span><span class="token punctuation">,</span>
        <span class="token string">'min_episodes'</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
        <span class="token string">'model'</span><span class="token punctuation">:</span> <span class="token string">'llama3.2:3b'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    max_trials<span class="token operator">=</span><span class="token number">40</span><span class="token punctuation">,</span>
    verbose<span class="token operator">=</span><span class="token boolean">True</span>
<span class="token punctuation">)</span>

<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">"ğŸ§  Starting LLM-enhanced time series optimization..."</span><span class="token punctuation">)</span>
results <span class="token operator">=</span> optimizer<span class="token punctuation">.</span><span class="token function">optimize</span><span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> X_val<span class="token punctuation">,</span> y_val<span class="token punctuation">)</span>

<span class="token comment"># ğŸ“Š Analyze results</span>
<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">f"\\nğŸ† LLM-Enhanced Results:"</span><span class="token punctuation">)</span>
<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">f"   F1 Score: {results['best_performance']['f1']:.4f}"</span><span class="token punctuation">)</span>
<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">f"   AUC: {results['best_performance']['auc']:.4f}"</span><span class="token punctuation">)</span>
<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">f"   G-mean: {results['best_performance']['gmean']:.4f}"</span><span class="token punctuation">)</span>

<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">f"\\nğŸ¯ LLM Usage Statistics:"</span><span class="token punctuation">)</span>
stats <span class="token operator">=</span> results<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'optimization_stats'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">f"   Total trials: {stats.get('trials_completed', 'N/A')}"</span><span class="token punctuation">)</span>
<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">f"   LLM interventions: {stats.get('llm_interventions', 'N/A')}"</span><span class="token punctuation">)</span>
<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">f"   Optimization time: {stats.get('optimization_time', 'N/A'):.2f}s"</span><span class="token punctuation">)</span></code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>â¤ï¸ Example 3: ECG Classification (Complete Pipeline)</h2>

                    <p>A complete example for ECG heartbeat classification using specialized configuration:</p>

                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-language">python</span>
                            <button class="copy-btn">Copy</button>
                        </div>
                        <pre><code class="language-python"><span class="token keyword">from</span> MAT_HPO_LIB <span class="token keyword">import</span> EasyHPO
<span class="token keyword">from</span> MAT_HPO_LIB<span class="token punctuation">.</span>easy_hpo <span class="token keyword">import</span> quick_ecg_optimize
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split

<span class="token comment"># ğŸ“Š Simulate realistic ECG data</span>
<span class="token keyword">def</span> <span class="token function">create_ecg_data</span><span class="token punctuation">(</span>n_samples<span class="token operator">=</span><span class="token number">2000</span><span class="token punctuation">,</span> signal_length<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">"""Generate synthetic ECG data for 9 cardiac conditions"""</span>
    X <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span><span class="token function">randn</span><span class="token punctuation">(</span>n_samples<span class="token punctuation">,</span> signal_length<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    y <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span><span class="token function">randint</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> n_samples<span class="token punctuation">)</span>  <span class="token comment"># 9 cardiac conditions</span>

    <span class="token comment"># Add realistic ECG patterns for each class</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n_samples<span class="token punctuation">)</span><span class="token punctuation">:</span>
        class_id <span class="token operator">=</span> y<span class="token punctuation">[</span>i<span class="token punctuation">]</span>

        <span class="token comment"># Normal sinus rhythm</span>
        <span class="token keyword">if</span> class_id <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token comment"># Regular QRS complexes</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> signal_length<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> j <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator"><</span> signal_length<span class="token punctuation">:</span>
                    X<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">:</span>j<span class="token operator">+</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">2</span> <span class="token operator">*</span> np<span class="token punctuation">.</span><span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span>np<span class="token punctuation">.</span><span class="token function">linspace</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token comment"># Atrial fibrillation - irregular rhythm</span>
        <span class="token keyword">elif</span> class_id <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
            <span class="token comment"># Irregular QRS complexes</span>
            positions <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span><span class="token function">randint</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> pos <span class="token keyword">in</span> positions<span class="token punctuation">:</span>
                <span class="token keyword">if</span> pos <span class="token operator">+</span> <span class="token number">15</span> <span class="token operator"><</span> signal_length<span class="token punctuation">:</span>
                    X<span class="token punctuation">[</span>i<span class="token punctuation">,</span> pos<span class="token punctuation">:</span>pos<span class="token operator">+</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1.5</span> <span class="token operator">*</span> np<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token function">linspace</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>pi<span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token comment"># Add noise and variations for other classes</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            X<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">0.5</span> <span class="token operator">*</span> class_id <span class="token operator">*</span> np<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token function">linspace</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">*</span>np<span class="token punctuation">.</span>pi<span class="token punctuation">,</span> signal_length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reshape</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> X<span class="token punctuation">,</span> y

<span class="token comment"># ğŸ“Š Generate ECG dataset</span>
<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">"ğŸ“Š Generating synthetic ECG data..."</span><span class="token punctuation">)</span>
X<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token function">create_ecg_data</span><span class="token punctuation">(</span>n_samples<span class="token operator">=</span><span class="token number">3000</span><span class="token punctuation">,</span> signal_length<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">)</span>

<span class="token comment"># ğŸ”€ Stratified split to maintain class distribution</span>
X_train<span class="token punctuation">,</span> X_val<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_val <span class="token operator">=</span> <span class="token function">train_test_split</span><span class="token punctuation">(</span>
    X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> stratify<span class="token operator">=</span>y<span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span>
<span class="token punctuation">)</span>

<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">f"ğŸ“Š Dataset shape: {X_train.shape}, Classes: {len(np.unique(y))}"</span><span class="token punctuation">)</span>

<span class="token comment"># ğŸš€ Method 1: Use convenience function</span>
<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">"\\nğŸš€ Method 1: Using convenience function..."</span><span class="token punctuation">)</span>
quick_results <span class="token operator">=</span> <span class="token function">quick_ecg_optimize</span><span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> X_val<span class="token punctuation">,</span> y_val<span class="token punctuation">)</span>
<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">f"Quick optimization result: {quick_results}"</span><span class="token punctuation">)</span>

<span class="token comment"># ğŸ§  Method 2: Full EasyHPO with LLM enhancement</span>
<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">"\\nğŸ§  Method 2: Full LLM-enhanced optimization..."</span><span class="token punctuation">)</span>
optimizer <span class="token operator">=</span> <span class="token function">EasyHPO</span><span class="token punctuation">(</span>
    task_type<span class="token operator">=</span><span class="token string">"ecg_classification"</span><span class="token punctuation">,</span>
    llm_enabled<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>              <span class="token comment"># ğŸ§  Use LLM for intelligent suggestions</span>
    llm_strategy<span class="token operator">=</span><span class="token string">"fixed_alpha"</span><span class="token punctuation">,</span>     <span class="token comment"># Stable strategy for ECG</span>
    llm_config<span class="token operator">=</span><span class="token punctuation">{</span>
        <span class="token string">'alpha'</span><span class="token punctuation">:</span> <span class="token number">0.3</span><span class="token punctuation">,</span>                  <span class="token comment"># 30% LLM + 70% RL</span>
        <span class="token string">'model'</span><span class="token punctuation">:</span> <span class="token string">'llama3.2:3b'</span><span class="token punctuation">,</span>
        <span class="token string">'cooldown'</span><span class="token punctuation">:</span> <span class="token number">3</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    max_trials<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span>                 <span class="token comment"># More trials for better ECG results</span>
    timeout_minutes<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span>             <span class="token comment"># Reasonable timeout</span>
    auto_save<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                  <span class="token comment"># Save results automatically</span>
    verbose<span class="token operator">=</span><span class="token boolean">True</span>
<span class="token punctuation">)</span>

<span class="token comment"># ğŸ¯ Run optimization</span>
<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">"ğŸ¯ Starting ECG hyperparameter optimization..."</span><span class="token punctuation">)</span>
results <span class="token operator">=</span> optimizer<span class="token punctuation">.</span><span class="token function">optimize</span><span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> X_val<span class="token punctuation">,</span> y_val<span class="token punctuation">)</span>

<span class="token comment"># ğŸ† Comprehensive results analysis</span>
<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">f"\\nğŸ† Final ECG Classification Results:"</span><span class="token punctuation">)</span>
<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">"="</span> <span class="token operator">*</span> <span class="token number">50</span><span class="token punctuation">)</span>

performance <span class="token operator">=</span> results<span class="token punctuation">[</span><span class="token string">'best_performance'</span><span class="token punctuation">]</span>
<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">f"ğŸ“ˆ Performance Metrics:"</span><span class="token punctuation">)</span>
<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">f"   F1 Score:  {performance['f1']:.4f}"</span><span class="token punctuation">)</span>
<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">f"   AUC:       {performance['auc']:.4f}"</span><span class="token punctuation">)</span>
<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">f"   G-mean:    {performance['gmean']:.4f}"</span><span class="token punctuation">)</span>

<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">f"\\nâš™ï¸ Optimized Hyperparameters:"</span><span class="token punctuation">)</span>
best_params <span class="token operator">=</span> results<span class="token punctuation">[</span><span class="token string">'best_hyperparameters'</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> param<span class="token punctuation">,</span> value <span class="token keyword">in</span> best_params<span class="token punctuation">.</span><span class="token function">items</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">f"   {param:20s}: {value}"</span><span class="token punctuation">)</span>

<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">f"\\nğŸ“Š Optimization Statistics:"</span><span class="token punctuation">)</span>
stats <span class="token operator">=</span> results<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'optimization_stats'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">f"   Total trials:     {stats.get('trials_completed', 'N/A')}"</span><span class="token punctuation">)</span>
<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">f"   LLM usage:        {stats.get('llm_interventions', 'N/A')} interventions"</span><span class="token punctuation">)</span>
<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">f"   Total time:       {stats.get('optimization_time', 'N/A'):.2f} seconds"</span><span class="token punctuation">)</span>
<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">f"   Convergence step: {stats.get('convergence_step', 'N/A')}"</span><span class="token punctuation">)</span>

<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">f"\\nğŸ’¾ Results saved to: {optimizer.output_dir if hasattr(optimizer, 'output_dir') else 'current directory'}"</span><span class="token punctuation">)</span></code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>ğŸ”— Example 4: Custom Pipeline with Model Factory</h2>

                    <p>Advanced usage with custom model creation and training pipeline:</p>

                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-language">python</span>
                            <button class="copy-btn">Copy</button>
                        </div>
                        <pre><code class="language-python"><span class="token keyword">from</span> MAT_HPO_LIB <span class="token keyword">import</span> EasyHPO<span class="token punctuation">,</span> HyperparameterSpace
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> RandomForestClassifier
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>neural_network <span class="token keyword">import</span> MLPClassifier
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> f1_score<span class="token punctuation">,</span> roc_auc_score

<span class="token comment"># ğŸ—ï¸ Custom model factory</span>
<span class="token keyword">def</span> <span class="token function">custom_model_factory</span><span class="token punctuation">(</span><span class="token operator">**</span>hyperparams<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">"""Create custom model based on hyperparameters"""</span>
    model_type <span class="token operator">=</span> hyperparams<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'model_type'</span><span class="token punctuation">,</span> <span class="token string">'rf'</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> model_type <span class="token operator">==</span> <span class="token string">'rf'</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token function">RandomForestClassifier</span><span class="token punctuation">(</span>
            n_estimators<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>hyperparams<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'n_estimators'</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            max_depth<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>hyperparams<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'max_depth'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            random_state<span class="token operator">=</span><span class="token number">42</span>
        <span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>  <span class="token comment"># mlp</span>
        <span class="token keyword">return</span> <span class="token function">MLPClassifier</span><span class="token punctuation">(</span>
            hidden_layer_sizes<span class="token operator">=</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>hyperparams<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'hidden_size'</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            learning_rate_init<span class="token operator">=</span>hyperparams<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'learning_rate'</span><span class="token punctuation">,</span> <span class="token number">0.001</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            max_iter<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span>
            random_state<span class="token operator">=</span><span class="token number">42</span>
        <span class="token punctuation">)</span>

<span class="token comment"># ğŸ“ Custom trainer</span>
<span class="token keyword">def</span> <span class="token function">custom_trainer</span><span class="token punctuation">(</span>model<span class="token punctuation">,</span> X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> <span class="token operator">**</span>hyperparams<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">"""Custom training logic"""</span>
    <span class="token comment"># Add preprocessing if needed</span>
    <span class="token keyword">if</span> hyperparams<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'normalize'</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> StandardScaler
        scaler <span class="token operator">=</span> <span class="token function">StandardScaler</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        X_train <span class="token operator">=</span> scaler<span class="token punctuation">.</span><span class="token function">fit_transform</span><span class="token punctuation">(</span>X_train<span class="token punctuation">)</span>
        model<span class="token punctuation">.</span>scaler <span class="token operator">=</span> scaler  <span class="token comment"># Store for evaluation</span>

    <span class="token comment"># Train the model</span>
    model<span class="token punctuation">.</span><span class="token function">fit</span><span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>
    <span class="token keyword">return</span> model

<span class="token comment"># ğŸ“Š Custom evaluator</span>
<span class="token keyword">def</span> <span class="token function">custom_evaluator</span><span class="token punctuation">(</span>model<span class="token punctuation">,</span> X_val<span class="token punctuation">,</span> y_val<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">"""Custom evaluation logic"""</span>
    <span class="token comment"># Apply same preprocessing as training</span>
    <span class="token keyword">if</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>model<span class="token punctuation">,</span> <span class="token string">'scaler'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        X_val <span class="token operator">=</span> model<span class="token punctuation">.</span>scaler<span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span>X_val<span class="token punctuation">)</span>

    <span class="token comment"># Make predictions</span>
    y_pred <span class="token operator">=</span> model<span class="token punctuation">.</span><span class="token function">predict</span><span class="token punctuation">(</span>X_val<span class="token punctuation">)</span>

    <span class="token comment"># Calculate metrics</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        y_pred_proba <span class="token operator">=</span> model<span class="token punctuation">.</span><span class="token function">predict_proba</span><span class="token punctuation">(</span>X_val<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token function">unique</span><span class="token punctuation">(</span>y_val<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>
            auc <span class="token operator">=</span> <span class="token function">roc_auc_score</span><span class="token punctuation">(</span>y_val<span class="token punctuation">,</span> y_pred_proba<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            auc <span class="token operator">=</span> <span class="token function">roc_auc_score</span><span class="token punctuation">(</span>y_val<span class="token punctuation">,</span> y_pred_proba<span class="token punctuation">,</span> multi_class<span class="token operator">=</span><span class="token string">'ovr'</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        auc <span class="token operator">=</span> <span class="token number">0.5</span>

    f1 <span class="token operator">=</span> <span class="token function">f1_score</span><span class="token punctuation">(</span>y_val<span class="token punctuation">,</span> y_pred<span class="token punctuation">,</span> average<span class="token operator">=</span><span class="token string">'weighted'</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token string">'f1'</span><span class="token punctuation">:</span> f1<span class="token punctuation">,</span>
        <span class="token string">'auc'</span><span class="token punctuation">:</span> auc<span class="token punctuation">,</span>
        <span class="token string">'accuracy'</span><span class="token punctuation">:</span> np<span class="token punctuation">.</span><span class="token function">mean</span><span class="token punctuation">(</span>y_pred <span class="token operator">==</span> y_val<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

<span class="token comment"># ğŸ“Š Create sample data</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> make_classification
X<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token function">make_classification</span><span class="token punctuation">(</span>n_samples<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span> n_features<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> n_classes<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
X_train<span class="token punctuation">,</span> X_val<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_val <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">)</span>

<span class="token comment"># ğŸ”§ Define custom hyperparameter space</span>
custom_space <span class="token operator">=</span> <span class="token function">HyperparameterSpace</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
custom_space<span class="token punctuation">.</span><span class="token function">add_discrete</span><span class="token punctuation">(</span><span class="token string">'model_type'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'rf'</span><span class="token punctuation">,</span> <span class="token string">'mlp'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> agent<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
custom_space<span class="token punctuation">.</span><span class="token function">add_continuous</span><span class="token punctuation">(</span><span class="token string">'n_estimators'</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> agent<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># For RF</span>
custom_space<span class="token punctuation">.</span><span class="token function">add_continuous</span><span class="token punctuation">(</span><span class="token string">'max_depth'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> agent<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>       <span class="token comment"># For RF</span>
custom_space<span class="token punctuation">.</span><span class="token function">add_continuous</span><span class="token punctuation">(</span><span class="token string">'hidden_size'</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> agent<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>     <span class="token comment"># For MLP</span>
custom_space<span class="token punctuation">.</span><span class="token function">add_continuous</span><span class="token punctuation">(</span><span class="token string">'learning_rate'</span><span class="token punctuation">,</span> <span class="token number">0.001</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">,</span> agent<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment"># For MLP</span>
custom_space<span class="token punctuation">.</span><span class="token function">add_boolean</span><span class="token punctuation">(</span><span class="token string">'normalize'</span><span class="token punctuation">,</span> agent<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>                           <span class="token comment"># Preprocessing</span>

<span class="token comment"># ğŸš€ Create optimizer with custom pipeline</span>
optimizer <span class="token operator">=</span> <span class="token function">EasyHPO</span><span class="token punctuation">(</span>
    task_type<span class="token operator">=</span><span class="token string">"classification"</span><span class="token punctuation">,</span>
    llm_enabled<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    llm_strategy<span class="token operator">=</span><span class="token string">"adaptive"</span><span class="token punctuation">,</span>
    max_trials<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">,</span>
    verbose<span class="token operator">=</span><span class="token boolean">True</span>
<span class="token punctuation">)</span>

<span class="token comment"># ğŸ¯ Run optimization with custom pipeline</span>
<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">"ğŸ¯ Starting custom pipeline optimization..."</span><span class="token punctuation">)</span>
results <span class="token operator">=</span> optimizer<span class="token punctuation">.</span><span class="token function">optimize_with_pipeline</span><span class="token punctuation">(</span>
    data_loader<span class="token operator">=</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> X_val<span class="token punctuation">,</span> y_val<span class="token punctuation">)</span><span class="token punctuation">,</span>
    model_factory<span class="token operator">=</span>custom_model_factory<span class="token punctuation">,</span>
    trainer<span class="token operator">=</span>custom_trainer<span class="token punctuation">,</span>
    evaluator<span class="token operator">=</span>custom_evaluator<span class="token punctuation">,</span>
    custom_space<span class="token operator">=</span>custom_space
<span class="token punctuation">)</span>

<span class="token comment"># ğŸ† Display results</span>
<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">f"\\nğŸ† Custom Pipeline Results:"</span><span class="token punctuation">)</span>
<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">f"   Best F1: {results['best_performance']['f1']:.4f}"</span><span class="token punctuation">)</span>
<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">f"   Best Model: {results['best_hyperparameters']['model_type']}"</span><span class="token punctuation">)</span>

<span class="token comment"># ğŸ—ï¸ Create final tuned model</span>
best_config <span class="token operator">=</span> optimizer<span class="token punctuation">.</span><span class="token function">get_best_config</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
final_model <span class="token operator">=</span> <span class="token function">custom_model_factory</span><span class="token punctuation">(</span><span class="token operator">**</span>best_config<span class="token punctuation">)</span>
<span class="token builtin">print</span><span class="token punctuation">(</span><span class="token string">f"ğŸ—ï¸ Final tuned model created: {type(final_model).__name__}"</span><span class="token punctuation">)</span></code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>ğŸ“š Next Steps</h2>

                    <div class="next-steps">
                        <div class="step-item">
                            <h3><a href="../llm-strategies.html">LLM Strategies Guide</a></h3>
                            <p>Learn about different LLM enhancement strategies</p>
                        </div>

                        <div class="step-item">
                            <h3><a href="full-control.html">Full Control Examples</a></h3>
                            <p>See examples using the complete MAT-HPO API</p>
                        </div>

                        <div class="step-item">
                            <h3><a href="../api/optimizer.html">API Reference</a></h3>
                            <p>Detailed documentation for all classes and methods</p>
                        </div>
                    </div>
                </section>

            </div>
        </main>
    </div>

    <script src="../js/main.js"></script>
</body>
</html>