<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Example - MAT-HPO Library</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ü§ñ</text></svg>">
</head>
<body>
    <button class="mobile-toggle">‚ò∞</button>
    
    <div class="container">
        <nav class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="logo">
                    <div class="logo-icon">M</div>
                    <div class="logo-text">
                        <h1>MAT-HPO</h1>
                        <p>Multi-Agent HPO</p>
                    </div>
                </a>
                <div style="margin-top: 1rem;">
                    <span class="version-badge">v1.0.0</span>
                </div>
            </div>
            
            <ul class="nav-menu">
                <li class="nav-item">
                    <div class="nav-section">Getting Started</div>
                </li>
                <li class="nav-item">
                    <a href="../index.html" class="nav-link">Home</a>
                </li>
                <li class="nav-item">
                    <a href="../installation.html" class="nav-link">Installation</a>
                </li>
                <li class="nav-item">
                    <a href="../quickstart.html" class="nav-link">Quick Start</a>
                </li>
                
                <li class="nav-item">
                    <div class="nav-section">API Reference</div>
                </li>
                <li class="nav-item">
                    <a href="../api/base-environment.html" class="nav-link">BaseEnvironment</a>
                </li>
                <li class="nav-item">
                    <a href="../api/hyperparameter-space.html" class="nav-link">HyperparameterSpace</a>
                </li>
                <li class="nav-item">
                    <a href="../api/optimizer.html" class="nav-link">MAT_HPO_Optimizer</a>
                </li>
                <li class="nav-item">
                    <a href="../api/configs.html" class="nav-link">Configs</a>
                </li>
                
                <li class="nav-item">
                    <div class="nav-section">Examples</div>
                </li>
                <li class="nav-item">
                    <a href="simple.html" class="nav-link active">Simple Example</a>
                </li>
                
                <li class="nav-item">
                    <div class="nav-section">Resources</div>
                </li>
                <li class="nav-item">
                    <a href="https://github.com/VM230705/MAT-HPO-Library" class="nav-link external">GitHub</a>
                </li>
            </ul>
        </nav>
        
        <main class="content">
            <div class="content-header">
                <nav class="breadcrumb">
                    <a href="../index.html">Home</a> &gt; <a href="./">Examples</a> &gt; Simple Example
                </nav>
                <h1>Simple Example</h1>
            </div>
            
            <div class="main-content">
                
                <section class="content-section">
                    <h2>üìã Neural Network Optimization</h2>
                    <p>Complete example optimizing a neural network for classification using MAT-HPO.</p>
                </section>
                
                <section class="content-section">
                    <h2>üîß 1. Environment Setup</h2>
                    
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-language">python</span>
                            <button class="copy-btn">Copy</button>
                        </div>
                        <pre><code>from MAT_HPO_LIB import BaseEnvironment, HyperparameterSpace, MAT_HPO_Optimizer
from MAT_HPO_LIB.utils import DefaultConfigs
import torch
import torch.nn as nn
from sklearn.datasets import make_classification
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score, f1_score

class SimpleNN(nn.Module):
    def __init__(self, input_dim, hidden_size, num_classes):
        super().__init__()
        self.fc1 = nn.Linear(input_dim, hidden_size)
        self.fc2 = nn.Linear(hidden_size, num_classes)
        self.relu = nn.ReLU()
        
    def forward(self, x):
        return self.fc2(self.relu(self.fc1(x)))</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>üèóÔ∏è 2. Define Environment</h2>
                    
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-language">python</span>
                            <button class="copy-btn">Copy</button>
                        </div>
                        <pre><code>class NeuralNetEnvironment(BaseEnvironment):
    def load_data(self):
        X, y = make_classification(n_samples=1000, n_features=20, n_classes=3, random_state=42)
        X_train, X_val, y_train, y_val = train_test_split(X, y, test_size=0.2, random_state=42)
        
        self.X_train = torch.FloatTensor(X_train)
        self.y_train = torch.LongTensor(y_train)
        self.X_val = torch.FloatTensor(X_val)
        self.y_val = torch.LongTensor(y_val)
        
        return {"samples": len(X_train), "features": X.shape[1], "classes": len(set(y))}
    
    def create_model(self, hyperparams):
        return SimpleNN(
            input_dim=20,
            hidden_size=int(hyperparams['hidden_size']),
            num_classes=3
        )
    
    def train_evaluate(self, model, hyperparams):
        optimizer = torch.optim.Adam(model.parameters(), lr=hyperparams['learning_rate'])
        criterion = nn.CrossEntropyLoss()
        
        # Simple training loop
        model.train()
        for epoch in range(20):
            optimizer.zero_grad()
            outputs = model(self.X_train)
            loss = criterion(outputs, self.y_train)
            loss.backward()
            optimizer.step()
        
        # Evaluation
        model.eval()
        with torch.no_grad():
            val_outputs = model(self.X_val)
            _, predicted = torch.max(val_outputs, 1)
            accuracy = accuracy_score(self.y_val.numpy(), predicted.numpy())
            f1 = f1_score(self.y_val.numpy(), predicted.numpy(), average='weighted')
        
        return {'accuracy': accuracy, 'f1': f1}
    
    def compute_reward(self, metrics):
        return metrics['f1']  # Optimize for F1-score</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>üéØ 3. Define Hyperparameters</h2>
                    
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-language">python</span>
                            <button class="copy-btn">Copy</button>
                        </div>
                        <pre><code>space = HyperparameterSpace(
    agent0_params=['weight_decay'],          # Problem-specific
    agent1_params=['hidden_size'],           # Architecture
    agent2_params=['learning_rate'],         # Training
    bounds={
        'weight_decay': (1e-6, 1e-3),
        'hidden_size': (32, 256),
        'learning_rate': (1e-4, 1e-2)
    },
    param_types={
        'weight_decay': float,
        'hidden_size': int,
        'learning_rate': float
    }
)</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>üöÄ 4. Run Optimization</h2>
                    
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-language">python</span>
                            <button class="copy-btn">Copy</button>
                        </div>
                        <pre><code>def main():
    # Create environment and load data
    environment = NeuralNetEnvironment()
    environment.load_data()
    
    # Setup optimization
    config = DefaultConfigs.standard()
    optimizer = MAT_HPO_Optimizer(
        environment=environment,
        hyperparameter_space=space,
        config=config
    )
    
    # Run optimization
    print("Starting optimization...")
    results = optimizer.optimize()
    
    # Print results
    print(f"Best parameters: {results['best_hyperparameters']}")
    print(f"Best performance: {results['best_performance']}")
    
    return results

if __name__ == "__main__":
    results = main()</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>üìä Expected Output</h2>
                    
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-language">text</span>
                            <button class="copy-btn">Copy</button>
                        </div>
                        <pre><code>Starting optimization...
[INFO] MAT-HPO Optimizer initialized successfully
Step 1/100: F1=0.8234, Parameters={'hidden_size': 128, 'learning_rate': 0.003, 'weight_decay': 0.0001}
...
Step 100/100: F1=0.9156, Parameters={'hidden_size': 164, 'learning_rate': 0.0012, 'weight_decay': 0.00034}

Best parameters: {'hidden_size': 164, 'learning_rate': 0.0012, 'weight_decay': 0.00034}
Best performance: 0.9156</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>üìÅ Results Files</h2>
                    <p>Results are automatically saved:</p>
                    <ul>
                        <li><code>best_hyperparams.json</code> - Best hyperparameters found</li>
                        <li><code>optimization_results.json</code> - Complete results</li>
                        <li><code>step_log.jsonl</code> - Step-by-step log</li>
                    </ul>
                </section>

                <section class="content-section">
                    <h2>üìö Next Steps</h2>
                    
                    <div class="next-steps">
                        <div class="step-item">
                            <h3><a href="../quickstart.html">More Examples</a></h3>
                            <p>Explore additional use cases and configurations</p>
                        </div>
                        
                        <div class="step-item">
                            <h3><a href="../api/base-environment.html">API Reference</a></h3>
                            <p>Complete documentation of all classes and methods</p>
                        </div>
                    </div>
                </section>
                
            </div>
        </main>
    </div>
    
    <script src="../js/main.js"></script>
</body>
</html>